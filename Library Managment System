/*CREATE TABLES:*/

CREATE TABLE BOOKS (
            BOOKID INT PRIMARY KEY,
            TITLE VARCHAR(200) NOT NULL,
            AUTHOR VARCHAR (200) NOT NULL,
            GENRE VARCHAR(100),
            PUBLISHEDYEAR DATE,
            QUANTITY INT NOT NULL
);

CREATE TABLE MEMBERS(
            MEMBERID INT PRIMARY KEY,
            NAME VARCHAR(200) NOT NULL,
            MAIL VARCHAR(100) UNIQUE,
            MOBILENUMBER INT UNIQUE,
            JOINDATE DATE
);

CREATE TABLE TRANSACTIONS(
             TRANSACTIONID INT PRIMARY KEY,
             BOOKID INT NOT NULL,
             MEMBERID INT NOT NULL,
             BORROWDATE DATE,
             RETURNDATE DATE,
             FOREIGN KEY (BOOKID) REFERENCES BOOKS (BOOKID),
             FOREIGN KEY (MEMBERID) REFERENCES MEMBERS (MEMBERID)
);


/*INSERT VALUES INTO BOOKS TABLE:*/

INSERT INTO BOOKS(
    BOOKID,
    TITLE,
    AUTHOR,
    GENRE,
    PUBLISHEDYEAR,
    QUANTITY
)
VALUES(
    1,
    'The Great Gatsby',
    'F. Scott Fitzgerald',
    'Classic',
    '1960-08-11',
    5
);

INSERT INTO BOOKS (
	BOOKID, 
	TITLE,
	AUTHOR, 
	GENRE, 
	PUBLISHEDYEAR, 
	QUANTITY
)
VALUES (
	2, 
	'GOD OF MASTERS', 
	'George Orwell', 
	'Dystopian', 
	'1949-06-08', 
	10
);

INSERT INTO BOOKS (
	BOOKID, 
	TITLE, 
	AUTHOR, 
	GENRE, 
	PUBLISHEDYEAR, 
	QUANTITY
)
 VALUES  (
	3,
	'To Kill a Mockingbird', 
	'Harper Lee', 
	'Fiction',
	'1960-07-11', 
	5
);

/*INSERT VALUES INTO MEMBERS TABLE:*/

INSERT INTO MEMBERS(
    MEMBERID,
    NAME,
    MAIL,
    MOBILENUMBER,
    JOINDATE
)
VALUES(
    1,
    'Alice Johnson',
    'alice.johnson@example.com',
    9876543210,
    '2023-01-15'
);

INSERT INTO MEMBERS(
    MEMBERID,
    NAME,
    MAIL,
    MOBILENUMBER,
    JOINDATE
)
VALUES(
    2,
    'Bob Smith',
    'bob.smith@example.com',
     1234567890,
    '2023-02-20'
);

INSERT INTO MEMBERS (
	MEMBERID, 
	NAME, 
	MAIL, 
	MOBILENUMBER, 
	JOINDATE
) 
VALUES (
	3, 
	'Charlie Brown', 
	'charlie.brown@example.com', 
	9876543212,
	'2023-03-12'
);

/*INSERT VALUES INTO IRANSACTIONS TABLE:*/

INSERT INTO TRANSACTIONS (
	TRANSACTIONID, 
	BOOKID, 
	MEMBERID, 
	BORROWDATE, 
	RETURNDATE
)
VALUES
(
	1, 
	3, 
	3, 
	'2024-12-01', 
	'2024-12-15'
);

/*UPDATE VALUES IN BOOKS TABLE:*/

UPDATE books
SET QUANTITY = 6
WHERE BOOKID=1;

/*DELETE VALUES IN BOOKS TABLE:*/

DELETE FROM books
WHERE BOOKID = 2;

DELETE FROM books
WHERE QUANTITY = 6;

/*RETRIVE DATA FROM BOOKS TABLE:*/

SELECT *FROM books;

SELECT *FROM books
WHERE BOOKID= 3;

/*UPDATE VALUES IN MEMBERS TABLE:*/

UPDATE members
SET MOBILENUMBER = 6543211234
WHERE MEMBERID=1;

UPDATE members
SET MEMBERID=3
WHERE MEMBERID=1;

/*DELETE DATA IN MEMBER TABLE:*/

DELETE FROM members WHERE MEMBERID=2;

/*RETRIVE DATA FROM MEMBERS TABLE:*/

SELECT *FROM members;

SELECT *FROM members
WHERE MEMBERID=3;

/*RETRIVE DATA FROM TRANSACTION TABLE:*/

SELECT *FROM transactions;

SELECT BORROWDATE FROM transactions
WHERE BOOKID = 3;

/* VIEW BORROWING HISTORY OF A MEMBER:*/

SELECT T.TRANSACTIONID, B.TITLE, T.BORROWDATE, T.RETURNDATE
FROM Transactions T
JOIN Books B ON T.BOOKID = B.BOOKID
WHERE T.MEMBERID = 1;

/*CHECK WHICH BOOKS ARE CURRENTLY BORROWED:*/

SELECT T.TRANSACTIONID, B.TITLE, M.NAME, T.BORROWDATE
FROM Transactions T
JOIN Books B ON T.BOOKID = B.BOOKID
JOIN Members M ON T.MEMBERID = M.MEMBERID
WHERE T.RETURNDATE IS NULL;
